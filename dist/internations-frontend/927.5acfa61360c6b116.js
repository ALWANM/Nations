"use strict";(self.webpackChunkInternationsFrontend=self.webpackChunkInternationsFrontend||[]).push([[927],{2927:(X,p,o)=>{o.r(p),o.d(p,{AddEditUserModule:()=>W});var u=o(9808),I=o(4449),n=o(3075),c=o(7423),g=o(4594),f=o(508),h=o(3071),N=o(9224),C=o(7446),F=o(7238),v=o(7531),b=o(4999),S=o(6087),A=o(8099),O=o(2638),J=o(2368),G=o(6688),Y=o(5899),L=o(8029),T=o(1271),U=o(9764),Z=o(4107),l=o(1083),x=o(1159),M=o(941),E=o(5783),t=o(5e3),B=o(1805),m=o(7093),y=o(7322);function Q(r,d){if(1&r&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&r){const e=d.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.groupName," ")}}function D(r,d){if(1&r&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Groups"),t.qZA(),t.TgZ(4,"mat-select",14,15),t.YNc(6,Q,2,2,"mat-option",16),t.qZA()(),t.BQk()),2&r){const e=d.ngIf;t.xp6(6),t.Q6J("ngForOf",e)}}function j(r,d){1&r&&(t.TgZ(0,"div",18)(1,"h3"),t._uU(2,"Add group and come back to add user"),t.qZA()())}function K(r,d){1&r&&(t.TgZ(0,"div",18)(1,"h3"),t._uU(2,"findind users ...."),t.qZA()())}const P=[{path:"",component:(()=>{class r{constructor(e,s,i,a,z){this.activatedRoute=e,this.groupService=s,this.userService=i,this.router=a,this.snackBar=z,this.userForm=new n.cw({firstname:new n.NI("",n.kI.required),lastname:new n.NI("",n.kI.required),email:new n.NI("",n.kI.email),groups:new n.NI("",n.kI.required)}),this.userToAdd=new E.n,this.btnText="Add",this.separatorKeysCodes=[x.K5,x.OC],this.groupsOfUserToAdd=[]}ngOnInit(){this.groups$=this.groupService.getGroups(),this.groupsToSearch=this.groupService.getGroups(),this.activatedRoute.queryParams.subscribe(e=>{console.log("Got the userid as: ",e.userid),this.userIdToEdit=+e.userid,console.log("this.userToAdd ",this.userIdToEdit)}),null!==this.userToAdd?(this.getUserToUpdate(this.userIdToEdit),console.log("this.userToAdd je suis la ",this.userIdToEdit)):(this.groupsOfUserToAdd=[],this.btnText="Add")}onSubmit(){this.userToAdd=new E.n,this.groupFoundInList=new M.Z,this.userToAdd.firstName=this.userForm.value.firstname,this.userToAdd.lastName=this.userForm.value.lastname,this.userToAdd.email=this.userForm.value.email,this.userToAdd.groups=[...this.groupsOfUserToAdd],this.userForm.get("groups").value.forEach(e=>{""!=e&&-1==this.userToAdd.groups.findIndex(i=>i.groupid==e.groupid)&&this.userToAdd.groups.push(e)}),"Add"==this.btnText?(this.updateGroups(this.userToAdd.groups,this.userToAdd),this.addUser(this.userToAdd)):(this.userToAdd.userid=this.userIdToEdit,this.updateGroups(this.userToAdd.groups,this.userToAdd),this.updateUser(this.userToAdd))}getUserToUpdate(e){this.userService.getUsersByUserId(e).subscribe({next:s=>{this.userToEdit$=s,this.userForm.patchValue({firstname:s.firstName,lastname:s.lastName,email:s.email}),this.groupsOfUserToAdd=s.groups,this.btnText="Update"},error:s=>console.error("error occur during getting user to update  "),complete:()=>console.info("add user complete")})}addUser(e){this.userService.addUser(e).subscribe({next:s=>{this.showSnackbarDuration("User"+e.firstName+" "+e.lastName+" added ","Done","5000"),console.log("user added ",s)},error:s=>console.error("error occur during adding user ",s),complete:()=>console.info("add user complete")})}updateUser(e){this.userService.updateUser(e).subscribe({next:s=>{this.showSnackbarDuration("User"+e.firstName+" "+e.lastName+" updated ","Done","5000"),console.log("this is the data "+s)},error:s=>console.error("error occur during updating user ",s),complete:()=>console.info("add user complete")})}updateGroups(e,s){e.forEach(i=>{i.users.push(s),this.groupService.updateGroup(i).subscribe({next:a=>{console.log("updating groups ",a)},error:a=>console.error("error occur during update group ",a),complete:()=>console.info("update user complete")})})}showSnackbarDuration(e,s,i){this.snackBar.open(e,s,i)}goUsers(){return this.router.navigate(["/users"])}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(l.gz),t.Y36(B.l),t.Y36(h.K),t.Y36(l.F0),t.Y36(T.ux))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-add-edit-user"]],decls:32,vars:7,consts:[["color","accent","fxLayout","row","fxLayoutAlign","space-between center",1,"content"],["mat-button","","color","primary",3,"click"],["color","primary"],[3,"formGroup","ngSubmit"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","16px grid"],["fxFlex","100%"],["appearance","outline",1,"form-field"],["matInput","","formControlName","firstname","name","firstname","required",""],["matInput","","formControlName","lastname","name","lastname","required",""],["matInput","","formControlName","email","name","email","required","","type","email"],[4,"ngIf","ngIfElse"],["nogroups",""],["mat-stroked-button","","color","primary","type","submit",3,"disabled"],["loading",""],["multiple","","formControlName","groups"],["select",""],["name","select",3,"value",4,"ngFor","ngForOf"],["name","select",3,"value"],[1,"loaing-container"]],template:function(e,s){if(1&e&&(t.TgZ(0,"mat-toolbar",0)(1,"button",1),t.NdJ("click",function(){return s.goUsers()}),t.TgZ(2,"mat-icon",2),t._uU(3,"keyboard_arrow_left"),t.qZA(),t._uU(4," Back "),t.qZA()(),t.TgZ(5,"form",3),t.NdJ("ngSubmit",function(){return s.onSubmit()}),t.TgZ(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),t._uU(10,"First Name"),t.qZA(),t._UZ(11,"input",7),t.qZA()(),t.TgZ(12,"div",5)(13,"mat-form-field",6)(14,"mat-label"),t._uU(15,"Last Name"),t.qZA(),t._UZ(16,"input",8),t.qZA()(),t.TgZ(17,"div",5)(18,"mat-form-field",6)(19,"mat-label"),t._uU(20,"Email"),t.qZA(),t._UZ(21,"input",9),t.qZA()(),t.TgZ(22,"div",5),t.YNc(23,D,7,1,"ng-container",10),t.ALo(24,"async"),t.YNc(25,j,3,0,"ng-template",null,11,t.W1O),t.qZA(),t.TgZ(27,"div",5)(28,"button",12),t._uU(29),t.qZA()()()(),t.YNc(30,K,3,0,"ng-template",null,13,t.W1O)),2&e){const i=t.MAs(26);t.xp6(5),t.Q6J("formGroup",s.userForm),t.xp6(18),t.Q6J("ngIf",t.lcZ(24,5,s.groups$))("ngIfElse",i),t.xp6(5),t.Q6J("disabled",!s.userForm.valid),t.xp6(1),t.hij(" ",s.btnText," ")}},directives:[g.Ye,m.xw,m.Wh,c.lW,A.Hw,n._Y,n.JL,n.sg,m.SQ,m.yH,y.KE,y.hX,v.Nt,n.Fj,n.JJ,n.u,n.Q7,u.O5,Z.gD,u.sg,f.ey],pipes:[u.Ov],styles:[".mat-card[_ngcontent-%COMP%]{background:#fafafa;color:coral}.grid-item[_ngcontent-%COMP%]{background-color:#ffa07a;border-radius:5px;padding:10px;min-width:300px;height:100px;margin:5px}"]}),r})()}];let R=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[l.Bz.forChild(P)],l.Bz]}),r})(),W=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[h.K],imports:[[u.ez,R,c.ot,f.us,N.QW,g.g0,c.ot,C.p9,F.AV,v.c,b.p0,S.TU,A.Ps,O.SJ,J.rP,G.Hi,Y.Cv,T.ZX,L.KP,U.o9,I.ie,U.o9,n.u5,n.UX,Z.LD]]}),r})()}}]);