"use strict";(self.webpackChunkInternationsFrontend=self.webpackChunkInternationsFrontend||[]).push([[570],{1570:(P,m,r)=>{r.r(m),r.d(m,{GroupAddEditModule:()=>W});var a=r(9808),U=r(4449),n=r(3075),g=r(7423),c=r(4594),h=r(508),I=r(9224),N=r(7446),C=r(7238),f=r(7531),F=r(4999),S=r(6087),v=r(8099),b=r(2638),J=r(2368),O=r(6688),Y=r(5899),B=r(8029),A=r(1271),T=r(9764),G=r(4107),p=r(1083),E=r(1159),x=r(941),o=r(5e3),y=r(1805),Q=r(3071),l=r(7093),Z=r(7322);function L(e,d){if(1&e&&(o.TgZ(0,"mat-option",15),o._uU(1),o.qZA()),2&e){const t=d.$implicit;o.Q6J("value",t),o.xp6(1),o.AsE(" ",t.firstName," ",t.lastName," ")}}function M(e,d){if(1&e&&(o.ynx(0),o.TgZ(1,"mat-form-field")(2,"mat-label"),o._uU(3,"Users"),o.qZA(),o.TgZ(4,"mat-select",12,13),o.YNc(6,L,2,3,"mat-option",14),o.qZA()(),o.BQk()),2&e){const t=d.ngIf;o.xp6(6),o.Q6J("ngForOf",t)}}function D(e,d){1&e&&(o.TgZ(0,"div",16)(1,"h3"),o._uU(2,"Add group and come back to add user"),o.qZA()())}function j(e,d){1&e&&(o.TgZ(0,"div",16)(1,"h3"),o._uU(2,"findind users ...."),o.qZA()())}const K=[{path:"",component:(()=>{class e{constructor(t,s,u,i,z){this.activatedRoute=t,this.groupService=s,this.userService=u,this.router=i,this.snackBar=z,this.groupForm=new n.cw({groupname:new n.NI("",n.kI.required),users:new n.NI("",n.kI.required)}),this.groupToAdd=new x.Z,this.btnText="Add",this.separatorKeysCodes=[E.K5,E.OC],this.usersOfGroupToAdd=[]}ngOnInit(){this.users$=this.userService.getUsers(),this.activatedRoute.queryParams.subscribe(t=>{console.log("Got the groupId as: ",t.groupid),this.groupIdToEdit=+t.groupid}),NaN!=this.groupIdToEdit?(console.log("this.userToAdd je suis la "),this.getGroupToUpdate(this.groupIdToEdit)):(this.usersOfGroupToAdd=[],this.btnText="Add")}onSubmit(){this.groupToAdd=new x.Z,this.groupToAdd.groupName=this.groupForm.value.groupname,this.groupToAdd.users=[...this.usersOfGroupToAdd],this.groupForm.get("users").value.forEach(t=>{""!=t&&-1==this.groupToAdd.users.findIndex(u=>u.userid==t.userid)&&this.groupToAdd.users.push(t)}),"Add"==this.btnText?(this.updateUsers(this.groupToAdd.users,this.groupToAdd),this.addGroup(this.groupToAdd)):(this.groupToAdd.groupid=this.groupIdToEdit,this.updateUsers(this.groupToAdd.users,this.groupToAdd),this.updateGroup(this.groupToAdd))}getGroupToUpdate(t){this.groupService.getGroupByGroupId(t).subscribe({next:s=>{this.groupToEdit$=s,this.groupForm.patchValue({groupname:s.groupName}),this.usersOfGroupToAdd=s.users,this.btnText="Update"},error:s=>console.error("error occur during getting group "),complete:()=>console.info("add group complete")})}addGroup(t){this.groupService.addGroup(t).subscribe({next:s=>{this.showSnackbarDuration("Group "+t.groupName+" added ","Done","5000"),console.log("group added  "+s)},error:s=>console.error("error occur during adding user ",s),complete:()=>console.info("add user complete")})}updateGroup(t){this.groupService.updateGroup(t).subscribe({next:s=>{this.showSnackbarDuration("User "+t.groupName+" updated ","Done","5000"),console.log("this is the data "+s)},error:s=>console.error("error occur during updating user ",s),complete:()=>console.info("add user complete")})}updateUsers(t,s){t.forEach(u=>{u.groups.push(s),this.userService.updateUser(u).subscribe({next:i=>{console.log("updating users "+i)},error:i=>console.error("error occur during update group "+i),complete:()=>console.info("update user complete")})})}goGroups(){return this.router.navigate(["/groups"])}showSnackbarDuration(t,s,u){this.snackBar.open(t,s,u)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(p.gz),o.Y36(y.l),o.Y36(Q.K),o.Y36(p.F0),o.Y36(A.ux))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-group-add-edit"]],decls:22,vars:7,consts:[["color","accent","fxLayout","row","fxLayoutAlign","space-between center",1,"content"],["mat-button","","color","primary",3,"click"],["color","primary"],[3,"formGroup","ngSubmit"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","16px grid"],["fxFlex","100%"],["appearance","outline",1,"form-field"],["matInput","","formControlName","groupname","name","groupname","required",""],[4,"ngIf","ngIfElse"],["nousers",""],["mat-stroked-button","","color","primary","type","submit",3,"disabled"],["loading",""],["multiple","","formControlName","users"],["select",""],["name","select",3,"value",4,"ngFor","ngForOf"],["name","select",3,"value"],[1,"loaing-container"]],template:function(t,s){if(1&t&&(o.TgZ(0,"mat-toolbar",0)(1,"button",1),o.NdJ("click",function(){return s.goGroups()}),o.TgZ(2,"mat-icon",2),o._uU(3,"keyboard_arrow_left"),o.qZA(),o._uU(4," Back "),o.qZA()(),o.TgZ(5,"form",3),o.NdJ("ngSubmit",function(){return s.onSubmit()}),o.TgZ(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),o._uU(10,"First Name"),o.qZA(),o._UZ(11,"input",7),o.qZA()(),o.TgZ(12,"div",5),o.YNc(13,M,7,1,"ng-container",8),o.ALo(14,"async"),o.YNc(15,D,3,0,"ng-template",null,9,o.W1O),o.qZA(),o.TgZ(17,"div",5)(18,"button",10),o._uU(19),o.qZA()()()(),o.YNc(20,j,3,0,"ng-template",null,11,o.W1O)),2&t){const u=o.MAs(16);o.xp6(5),o.Q6J("formGroup",s.groupForm),o.xp6(8),o.Q6J("ngIf",o.lcZ(14,5,s.users$))("ngIfElse",u),o.xp6(5),o.Q6J("disabled",!s.groupForm.valid),o.xp6(1),o.hij(" ",s.btnText," ")}},directives:[c.Ye,l.xw,l.Wh,g.lW,v.Hw,n._Y,n.JL,n.sg,l.SQ,l.yH,Z.KE,Z.hX,f.Nt,n.Fj,n.JJ,n.u,n.Q7,a.O5,G.gD,a.sg,h.ey],pipes:[a.Ov],styles:[""]}),e})()}];let R=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[p.Bz.forChild(K)],p.Bz]}),e})(),W=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({providers:[y.l],imports:[[a.ez,R,g.ot,h.us,I.QW,c.g0,g.ot,N.p9,C.AV,f.c,F.p0,S.TU,v.Ps,b.SJ,J.rP,O.Hi,Y.Cv,A.ZX,B.KP,T.o9,U.ie,T.o9,n.u5,n.UX,G.LD]]}),e})()}}]);