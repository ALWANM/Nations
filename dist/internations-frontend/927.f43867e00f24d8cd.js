"use strict";(self.webpackChunkInternationsFrontend=self.webpackChunkInternationsFrontend||[]).push([[927],{2927:(X,g,o)=>{o.r(g),o.d(g,{AddEditUserModule:()=>W});var a=o(9808),N=o(4449),n=o(3075),c=o(7423),p=o(4594),f=o(508),h=o(3071),C=o(9224),F=o(7446),b=o(7238),v=o(7531),S=o(4999),O=o(6087),A=o(8099),J=o(2638),L=o(2368),Y=o(6688),G=o(5899),M=o(8029),T=o(1271),U=o(9764),Z=o(4107),l=o(1083),x=o(1159),E=o(941),y=o(5783),t=o(5e3),B=o(1805),m=o(7093),I=o(7322);function Q(s,i){if(1&s&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&s){const e=i.$implicit;t.Q6J("value",e.groupName),t.xp6(1),t.hij(" ",e.groupName," ")}}function j(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Groups"),t.qZA(),t.TgZ(4,"mat-select",14,15),t.YNc(6,Q,2,2,"mat-option",16),t.qZA()(),t.BQk()),2&s){const e=i.ngIf;t.xp6(6),t.Q6J("ngForOf",e)}}function D(s,i){1&s&&(t.TgZ(0,"div",18)(1,"h3"),t._uU(2,"Add group and come back to add user"),t.qZA()())}function K(s,i){1&s&&(t.TgZ(0,"div",18)(1,"h3"),t._uU(2,"findind users ...."),t.qZA()())}const P=[{path:"",component:(()=>{class s{constructor(e,r,d,u,z){this.activatedRoute=e,this.groupService=r,this.userService=d,this.router=u,this.snackBar=z,this.userForm=new n.cw({firstname:new n.NI("",n.kI.required),lastname:new n.NI("",n.kI.required),email:new n.NI("",n.kI.email),groups:new n.NI("",n.kI.required)}),this.userToAdd=new y.n,this.btnText="Add",this.separatorKeysCodes=[x.K5,x.OC],this.groupsOfUserToAdd=[]}ngOnInit(){this.groups$=this.groupService.getGroups(),this.groupsToSearch=this.groupService.getGroups(),this.activatedRoute.queryParams.subscribe(e=>{console.log("Got the userid as: ",e.userid),this.userIdToEdit=+e.userid,console.log("this.userToAdd ",this.userIdToEdit)}),null!==this.userToAdd?(this.getUserToUpdate(this.userIdToEdit),console.log("this.userToAdd je suis la ",this.userIdToEdit)):(this.groupsOfUserToAdd=[],this.btnText="Add")}onSubmit(){this.userToAdd=new y.n,this.groupFoundInList=new E.Z,this.userToAdd.firstName=this.userForm.value.firstname,this.userToAdd.lastName=this.userForm.value.lastname,this.userToAdd.email=this.userForm.value.email,this.userToAdd.groups=[...this.groupsOfUserToAdd],this.userForm.get("groups").value.forEach(e=>{if(""!=e){console.log(" group ",e);let r=new E.Z;r.groupName=e,r.users=[this.userToAdd],this.userToAdd.groups.push(r)}}),"Add"==this.btnText?(this.addUser(this.userToAdd),this.updateGroups(this.userToAdd.groups,this.userToAdd)):(this.userToAdd.userid=this.userIdToEdit,this.updateUser(this.userToAdd))}getUserToUpdate(e){this.userService.getUsersByUserId(e).subscribe({next:r=>{this.userToEdit$=r,this.userForm.patchValue({firstname:r.firstName,lastname:r.lastName,email:r.email}),this.groupsOfUserToAdd=r.groups,this.btnText="Update"},error:r=>console.error("error occur during getting user to update  "),complete:()=>console.info("add user complete")})}addUser(e){this.userService.addUser(e).subscribe({next:r=>{this.showSnackbarDuration("User"+e.firstName+" "+e.lastName+" added ","Done","5000"),console.log("user added ",r)},error:r=>console.error("error occur during adding user ",r),complete:()=>console.info("add user complete")})}updateUser(e){this.userService.updateUser(e).subscribe({next:r=>{this.showSnackbarDuration("User"+e.firstName+" "+e.lastName+" updated ","Done","5000"),console.log("this is the data "+r)},error:r=>console.error("error occur during updating user ",r),complete:()=>console.info("add user complete")})}updateGroups(e,r){e.forEach(d=>{d.users.push(r),this.groupService.updateGroup(d).subscribe({next:u=>{console.log("updating groups ",u)},error:u=>console.error("error occur during update group ",u),complete:()=>console.info("update user complete")})})}showSnackbarDuration(e,r,d){this.snackBar.open(e,r,d)}goUsers(){return this.router.navigate(["/users"])}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(l.gz),t.Y36(B.l),t.Y36(h.K),t.Y36(l.F0),t.Y36(T.ux))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-add-edit-user"]],decls:35,vars:10,consts:[["color","accent","fxLayout","row","fxLayoutAlign","space-between center",1,"content"],["mat-button","","color","primary",3,"click"],["color","primary"],[3,"formGroup","ngSubmit"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","16px grid"],["fxFlex","100%"],["appearance","outline",1,"form-field"],["matInput","","formControlName","firstname","name","firstname","required",""],["matInput","","formControlName","lastname","name","lastname","required",""],["matInput","","formControlName","email","name","email","required","","type","email"],[4,"ngIf","ngIfElse"],["nogroups",""],["mat-stroked-button","","color","primary","type","submit",3,"disabled"],["loading",""],["multiple","","formControlName","groups"],["select",""],["name","select",3,"value",4,"ngFor","ngForOf"],["name","select",3,"value"],[1,"loaing-container"]],template:function(e,r){if(1&e&&(t.TgZ(0,"mat-toolbar",0)(1,"button",1),t.NdJ("click",function(){return r.goUsers()}),t.TgZ(2,"mat-icon",2),t._uU(3,"keyboard_arrow_left"),t.qZA(),t._uU(4," Back "),t.qZA()(),t.TgZ(5,"form",3),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),t._uU(10,"First Name"),t.qZA(),t._UZ(11,"input",7),t.qZA()(),t.TgZ(12,"div",5)(13,"mat-form-field",6)(14,"mat-label"),t._uU(15,"Last Name"),t.qZA(),t._UZ(16,"input",8),t.qZA()(),t.TgZ(17,"div",5)(18,"mat-form-field",6)(19,"mat-label"),t._uU(20,"Email"),t.qZA(),t._UZ(21,"input",9),t.qZA()(),t.TgZ(22,"div",5),t.YNc(23,j,7,1,"ng-container",10),t.ALo(24,"async"),t.YNc(25,D,3,0,"ng-template",null,11,t.W1O),t.qZA(),t.TgZ(27,"div",5)(28,"button",12),t._uU(29),t.qZA()(),t.TgZ(30,"p"),t._uU(31),t.ALo(32,"json"),t.qZA()()(),t.YNc(33,K,3,0,"ng-template",null,13,t.W1O)),2&e){const d=t.MAs(26);t.xp6(5),t.Q6J("formGroup",r.userForm),t.xp6(18),t.Q6J("ngIf",t.lcZ(24,6,r.groups$))("ngIfElse",d),t.xp6(5),t.Q6J("disabled",!r.userForm.valid),t.xp6(1),t.hij(" ",r.btnText," "),t.xp6(2),t.Oqu(t.lcZ(32,8,r.userForm.get("groups").value[0]))}},directives:[p.Ye,m.xw,m.Wh,c.lW,A.Hw,n._Y,n.JL,n.sg,m.SQ,m.yH,I.KE,I.hX,v.Nt,n.Fj,n.JJ,n.u,n.Q7,a.O5,Z.gD,a.sg,f.ey],pipes:[a.Ov,a.Ts],styles:[".mat-card[_ngcontent-%COMP%]{background:#fafafa;color:coral}.grid-item[_ngcontent-%COMP%]{background-color:#ffa07a;border-radius:5px;padding:10px;min-width:300px;height:100px;margin:5px}"]}),s})()}];let R=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[l.Bz.forChild(P)],l.Bz]}),s})(),W=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[h.K],imports:[[a.ez,R,c.ot,f.us,C.QW,p.g0,c.ot,F.p9,b.AV,v.c,S.p0,O.TU,A.Ps,J.SJ,L.rP,Y.Hi,G.Cv,T.ZX,M.KP,U.o9,N.ie,U.o9,n.u5,n.UX,Z.LD]]}),s})()}}]);