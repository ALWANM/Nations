"use strict";(self.webpackChunkInternationsFrontend=self.webpackChunkInternationsFrontend||[]).push([[570],{1570:(P,m,r)=>{r.r(m),r.d(m,{GroupAddEditModule:()=>W});var p=r(9808),U=r(4449),n=r(3075),c=r(7423),h=r(4594),f=r(508),i=r(9224),I=r(7446),N=r(7238),v=r(7531),C=r(4999),S=r(6087),A=r(8099),b=r(2638),J=r(2368),O=r(6688),Y=r(5899),B=r(8029),T=r(1271),G=r(9764),E=r(4107),l=r(1083),Z=r(1159),x=r(941),o=r(5e3),y=r(1805),L=r(3071),g=r(7093),F=r(7322);function Q(e,d){if(1&e&&(o.TgZ(0,"mat-option",16),o._uU(1),o.qZA()),2&e){const t=d.$implicit;o.Q6J("value",t),o.xp6(1),o.AsE(" ",t.firstName," ",t.lastName," ")}}function M(e,d){if(1&e&&(o.ynx(0),o.TgZ(1,"mat-form-field")(2,"mat-label"),o._uU(3,"Users"),o.qZA(),o.TgZ(4,"mat-select",13,14),o.YNc(6,Q,2,3,"mat-option",15),o.qZA()(),o.BQk()),2&e){const t=d.ngIf;o.xp6(6),o.Q6J("ngForOf",t)}}function D(e,d){1&e&&o._UZ(0,"div",17)}function j(e,d){1&e&&(o.TgZ(0,"div",17)(1,"h3"),o._uU(2,"Loadin.."),o.qZA()())}const K=[{path:"",component:(()=>{class e{constructor(t,s,u,a,z){this.activatedRoute=t,this.groupService=s,this.userService=u,this.router=a,this.snackBar=z,this.groupForm=new n.cw({groupname:new n.NI("",n.kI.required),users:new n.NI("",n.kI.required)}),this.groupToAdd=new x.Z,this.btnText="Add",this.separatorKeysCodes=[Z.K5,Z.OC],this.usersOfGroupToAdd=[]}ngOnInit(){this.users$=this.userService.getUsers(),this.activatedRoute.queryParams.subscribe(t=>{console.log("Got the groupId as: ",t.groupid),this.groupIdToEdit=+t.groupid}),NaN!=this.groupIdToEdit?(console.log("this.userToAdd je suis la "),this.getGroupToUpdate(this.groupIdToEdit)):(this.usersOfGroupToAdd=[],this.btnText="Add")}onSubmit(){this.groupToAdd=new x.Z,this.groupToAdd.groupName=this.groupForm.value.groupname,this.groupToAdd.users=[...this.usersOfGroupToAdd],this.groupForm.get("users").value.forEach(t=>{""!=t&&-1==this.groupToAdd.users.findIndex(u=>u.userid==t.userid)&&this.groupToAdd.users.push(t)}),"Add"==this.btnText?(this.updateUsers(this.groupToAdd.users,this.groupToAdd),this.addGroup(this.groupToAdd)):(this.groupToAdd.groupid=this.groupIdToEdit,this.updateUsers(this.groupToAdd.users,this.groupToAdd),this.updateGroup(this.groupToAdd))}getGroupToUpdate(t){this.groupService.getGroupByGroupId(t).subscribe({next:s=>{this.groupToEdit$=s,this.groupForm.patchValue({groupname:s.groupName}),this.usersOfGroupToAdd=s.users,this.btnText="Update"},error:s=>console.error("error occur during getting group "),complete:()=>console.info("add group complete")})}addGroup(t){this.groupService.addGroup(t).subscribe({next:s=>{this.showSnackbarDuration("Group "+t.groupName+" added ","Done","5000"),console.log("group added  "+s)},error:s=>console.error("error occur during adding user ",s),complete:()=>console.info("add user complete")})}updateGroup(t){this.groupService.updateGroup(t).subscribe({next:s=>{this.showSnackbarDuration("User "+t.groupName+" updated ","Done","5000"),console.log("this is the data "+s)},error:s=>console.error("error occur during updating user ",s),complete:()=>console.info("add user complete")})}updateUsers(t,s){t.forEach(u=>{u.groups.push(s),this.userService.updateUser(u).subscribe({next:a=>{console.log("updating users "+a)},error:a=>console.error("error occur during update group "+a),complete:()=>console.info("update user complete")})})}goGroups(){return this.router.navigate(["/groups"])}showSnackbarDuration(t,s,u){this.snackBar.open(t,s,u)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(l.gz),o.Y36(y.l),o.Y36(L.K),o.Y36(l.F0),o.Y36(T.ux))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-group-add-edit"]],decls:27,vars:7,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"content",2,"background-color","#F5F6F7"],["mat-button","","color","primary",3,"click"],["color","primary"],[1,"container",2,"height","auto","background-color","#1f70a1","color","#F5F6F7"],[3,"formGroup","ngSubmit"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","16px grid"],["fxFlex","100%"],["appearance","outline",1,"form-field"],["matInput","","formControlName","groupname","name","groupname","required",""],[4,"ngIf","ngIfElse"],["nousers",""],["mat-stroked-button","","color","primary","type","submit",3,"disabled"],["loading",""],["multiple","","formControlName","users"],["select",""],["name","select",3,"value",4,"ngFor","ngForOf"],["name","select",3,"value"],[1,"loaing-container"]],template:function(t,s){if(1&t&&(o.TgZ(0,"mat-toolbar",0)(1,"button",1),o.NdJ("click",function(){return s.goGroups()}),o.TgZ(2,"mat-icon",2),o._uU(3,"keyboard_arrow_left"),o.qZA(),o._uU(4," Back "),o.qZA()(),o.TgZ(5,"mat-card",3)(6,"mat-card-header")(7,"mat-card-title"),o._uU(8,"Group informations"),o.qZA()(),o.TgZ(9,"mat-card-content")(10,"form",4),o.NdJ("ngSubmit",function(){return s.onSubmit()}),o.TgZ(11,"div",5)(12,"div",6)(13,"mat-form-field",7)(14,"mat-label"),o._uU(15,"Group Name"),o.qZA(),o._UZ(16,"input",8),o.qZA()(),o.TgZ(17,"div",6),o.YNc(18,M,7,1,"ng-container",9),o.ALo(19,"async"),o.YNc(20,D,1,0,"ng-template",null,10,o.W1O),o.qZA(),o.TgZ(22,"div",6)(23,"button",11),o._uU(24),o.qZA()()()(),o.YNc(25,j,3,0,"ng-template",null,12,o.W1O),o.qZA()()),2&t){const u=o.MAs(21);o.xp6(10),o.Q6J("formGroup",s.groupForm),o.xp6(8),o.Q6J("ngIf",o.lcZ(19,5,s.users$))("ngIfElse",u),o.xp6(5),o.Q6J("disabled",!s.groupForm.valid),o.xp6(1),o.hij(" ",s.btnText," ")}},directives:[h.Ye,g.xw,g.Wh,c.lW,A.Hw,i.a8,i.dk,i.n5,i.dn,n._Y,n.JL,n.sg,g.SQ,g.yH,F.KE,F.hX,v.Nt,n.Fj,n.JJ,n.u,n.Q7,p.O5,E.gD,p.sg,f.ey],pipes:[p.Ov],styles:[""]}),e})()}];let R=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[l.Bz.forChild(K)],l.Bz]}),e})(),W=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({providers:[y.l],imports:[[p.ez,R,c.ot,f.us,i.QW,h.g0,c.ot,I.p9,N.AV,v.c,C.p0,S.TU,A.Ps,b.SJ,J.rP,O.Hi,Y.Cv,T.ZX,B.KP,G.o9,U.ie,G.o9,n.u5,n.UX,E.LD]]}),e})()}}]);